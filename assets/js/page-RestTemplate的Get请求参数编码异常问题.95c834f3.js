(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{759:function(t,s,a){"use strict";a.r(s);var e=a(1),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://blog.csdn.net/liuyueyi25/article/details/88842702",target:"_blank",rel:"noopener noreferrer"}},[t._v("Spring-RestTemplate之urlencode参数解析异常全程分析"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://blog.csdn.net/xs_challenge/article/details/109451263?depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-3.control",target:"_blank",rel:"noopener noreferrer"}},[t._v("RestTemplate的Get请求参数urlencode编码加密后请求异常的解决方案"),a("OutboundLink")],1)])])])]),t._v(" "),a("h2",{attrs:{id:"问题描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题描述"}},[t._v("#")]),t._v(" 问题描述")]),t._v(" "),a("p",[t._v("之前在学校做的某个虚拟仿真项目要接入 ilab-x 平台，根据平台提供的接口，需要由后端发送一些数据过去进行对接。")]),t._v(" "),a("p",[t._v("搞后端的老伙计顺手用了 RestTemplate，但是发过去的 Get 请求如果平台提供的 ticket 有 + 号可以不能正常获取到 access_token。")]),t._v(" "),a("p",[t._v("老伙计搞了半天还在质疑平台提供的 ticket 或者 urlencode 有问题，甚至想出了替换某些符号的骚操作的方法（话说有这时间搜索解决一下不就行了）")]),t._v(" "),a("h2",{attrs:{id:"问题原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题原因"}},[t._v("#")]),t._v(" 问题原因")]),t._v(" "),a("p",[t._v("老伙计的采用了字符串拼接参数的方法，并且各参数都没有进行 urlencode，我起初以为是直接拼接没有编码的原因，帮他改成编码后反而全部情况都请求异常了。")]),t._v(" "),a("p",[t._v("我不禁怀疑是 RestTemplate 对 url 编码处理有些不同的原因，搜了一下，还是找到了原因，跟 RFC3986 编码协议有关。")]),t._v(" "),a("p",[t._v("RestTemplate 对 url 编码遵循 RFC3986 编码协议，具体原因可参考"),a("a",{attrs:{href:"https://blog.csdn.net/liuyueyi25/article/details/88842702",target:"_blank",rel:"noopener noreferrer"}},[t._v("Spring-RestTemplate之urlencode参数解析异常全程分析"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"粗暴的解决方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#粗暴的解决方法"}},[t._v("#")]),t._v(" 粗暴的解决方法")]),t._v(" "),a("p",[t._v("毕竟项目这部分不是我负责，我也不想对他写的各项请求进行大概，只能找些简单粗暴的方法：")]),t._v(" "),a("p",[t._v("可以先对各参数进 encode，然后提供 url 使用 Uri.create() 的方法。")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.xxx.com?param1="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("URLEncoder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("encode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("param1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseEntity")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getForEntity")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("URI"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);